<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Wijit-Code Web Component</title>
	<script type="module" src="src/wijit-code.js"></script>
	<script type="module" src="extra/wijit-form.js"></script>
	<script type="module" src="extra/wijit-tabs.js"></script>
	<link rel="stylesheet" href="styles.css">

	<style>
		wijit-code {
			--indent: 2;
	    	background-color: var(--bg1);
	    	border-radius: .5rem;
			font-weight: normal;
			padding: .5rem;
			min-width: 300px;
	    }

	    wijit-code[inline] {
			overflow: auto;
	    	padding: .25rem;
	    }

	    textarea {
	    	flex-basis: 500px;
	    }
	</style>
</head>
<body>
	<h1>Wijit-Code Web Component</h1>
	<p>A custom element for displaying code snippets with consistent formatting.</p>

	<details>
	<summary>Instructions</summary>

		<h2>Usage</h2>
		<section>
			<header>
				<ul>
					<li><h3>Add the Script</h3>
						<ul>
							<li><code>
							&lt;script type="module" src="wijit-code.js">&lt;/script>
							</code></li>
						</ul>
					</li>
					<li><h3>Wrap your code in a
						<wijit-code inline><wijit-code></wijit-code></wijit-code>
						 tag</h3>
					</li>
				</ul>
			</header>

			<wijit-code>
				<wijit-code >
					<div>
						<strong>Some HTML</strong>
					</div>
				</wijit-code >
			</wijit-code>

			<wijit-code>
				<wijit-code >
					function someFunction(value) {
						return value;
					}
				</wijit-code >
			</wijit-code>
		</section>
		<section>
			<h2>Available Attributes</h2>
			<ul>
				<li><strong>inline</strong> (default: false) | Acceptable values [null, 'true', 'false']
					<ul>
						<li>Add this attribute if you want the code to appear inline instead of as a block of text. It does not require a value, but if you need to give it a value for some reason, use "true" or "false". "false" negates the effect as if the attribute were not present at all. If you need to adjust the css for inline code, the css selector is: <wijit-code inline>wijit-code[inline]{...}</wijit-code></li>
					</ul>
				</li>

				<li><strong>indent</strong> (default: 2) | Acceptable values [any positive integer or most css lengths such as 4px, 4rem etc]
					<ul>
						<li>Add this attribute to customize the degree of indentation.</li>
					</ul>
				</li>
			</ul>
		</section>
	</details>

	<h2>Demo</h2>
	<wijit-form wait="false" success="false">
		<section class="row center">
			<div>
				<label for="demo-indent">indent</label>
				<input name="indent" value="2" id="demo-indent" list="demo-indents" oninput="change(this, 'indent')">
				<datalist id="demo-indents">
					<option>1</option>
					<option>2</option>
					<option>3</option>
					<option>4</option>
					<option>1rem</option>
					<option>2rem</option>
					<option>3rem</option>
					<option>4rem</option>
					<option>1px</option>
					<option>2px</option>
					<option>3px</option>
					<option>4px</option>
				</datalist>
			</div>
			<div>
				<label for="demo-highlight">highlight</label>
				<select id="demo-highlight" onchange="change(this, 'highlight')">
					<option disabled selected></option>
					<option>false</option>
					<option>javascript</option>
					<option>html</option>
				</select>
			</div>
			<div>
				<label for="demo-inline">inline</label>
				<input type="checkbox" name="inline" id="demo-inline" onchange="change(this, 'inline')">
			</div>
		</section>
		<section>
			<details>
				<summary>Javascript</summary>
				<wijit-code class="demo" highlight="javascript">
					#! hashbang

					/**
					 * @function foo
					 * @description Does foo things
					 *
					 * @param {HTMLElement}	element An HTML element
					 */
					function foo (element) {
						let bar, output = '';
						const baz = "boom";
						const result = document.querySelector('#result');
						const bing = ["one", 123.456, -12.5, +100, "3px", 2^3, 2.5e3, 1.2E-3, 1**2, 0x123, 0xFAF];

						bar = 2 * 3;

						// This is a comment
						/*Another comment*/
						for (const child of element.children) {
							for (const attr of child.attributes) {
								output += `${attr.name} -> ${attr.value}\n`;
							}
						}

						someElement.addEventListener('click', event => {
							console.log(event);
						});

						const func = (arg) => arg.toLowerCase();

						result.textContent = output;
					}
				</wijt-code>
			</details>

			<details>
				<summary>HTML</summary>
				<wijit-code class="demo" highlight="html">
					<textarea>
						<!-- Comment -->
						<!--A
							multi-line
							comment-->

						<img src="false" onerror="alert('foo')">

						<p class="some-class">Some Text</p>
						<div>
							<label for="test-number" data-foo="" id=foo>Number</label>

							<input
								name="input"
								value="2"
								id="test-number"
								list="test-numbers"
								oninput="doSomething(event)">

							<datalist id="test-numbers">
								<option>1</option>
								<option>123.456</option>
								<option>-12.5</option>
								<option>+100</option>
								<option>3px</option>
								<option>2.5e3</option>
								<option>1.2e-3</option>
								<option>0x123</option>
								<option>9.876E-9</option>
								<option>0xFAF</option>
							</datalist>
						</div>
					</textarea>
				</wijit-code>
			</details>
		</section>
	</wijit-form>

	<section id="inline-examples">
		<header><h2>Inline Code</h2></header>
		<div class="row">
			<wijit-code inline>
				<wijit-code inline="true" >...</wijit-code >
			</wijit-code>
		</div>
		<div>
			<p>Some text <wijit-code inline> function foo() {}</wijit-code> some more text.</p>
		</div>
		<div class="row">
			<wijit-code inline>
				function foo (baz, bam) {
					for (const bar of baz) {
						for (const boom of bam) {
							if (bar === boom) {
								value = bam;
							} else {
								value = baz;
							}
						}
					}
				}
			</wijit-code>
		</div>
	</section>

	<section class="row" id="indent-highlight">
		<div>
			<header><h3>Indent (integer)</h3></header>
			<wijit-code indent="4">
				<wijit-code indent="4" >
					<article>
						<h1>A Title</h1>
						<p>Some text</p>
					</article>
				</wijit-code >
			</wijit-code>
		</div>

		<div>
			<header><h3>Indent (css length)</h3></header>
			<wijit-code html indent=".5rem">
				<wijit-code indent=".5rem" >
					<article>
						<h1>A Title</h1>
						<p>Some text</p>
					</article>
				</wijit-code >
			</wijit-code>
		</div>

		<div>
			<header><h3>Highlight Code</h3></header>
			<wijit-code highlight="html">
				<wijit-code highlight="html">
					<article>
						<h1>A Title</h1>
						<p class="foo">Some text</p>
					</article>
				</wijit-code>
			</wijit-code>
		</div>
	</section>

		<wijit-tabs>
			<wijit-tab open>
				<b slot="title">Tab A</b>
				<div class="tab-content">
					<p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
				</div>
			</wijit-tab>
			<wijit-tab>
				<b slot="title">Tab B</b>
				<div class="tab-content">
					<p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
				</div>
			</wijit-tab>
		</wijit-tabs>

	<script>
		const demo = document.querySelector('wijit-code#demo');
		const inputs = document.querySelectorAll('input');

		// Enable tabbing inside of textarea
		/*textarea.addEventListener('keydown', (event) => {
			if (event.key === 'Tab') {
				event.preventDefault();
				const ta = event.target;
				const start = ta.selectionStart;
				const end = ta.selectionEnd;
				const before = ta.value.substring(0, start);
				const after = ta.value.substring(end);
				ta.value = before + "\t" + after;
				ta.selectionStart = ta.selectionEnd = start + 1;
				const inputEvent = new Event ('input');
				ta.dispatchEvent(inputEvent);
    		}
		});*/

		// Change attributes on demo element.
		function change(elem, attr) {
			let value = elem.value;

			switch (attr) {
			case "inline":
				value = (elem.checked) ? 'true' : 'false';
				break;
			case "highlight":
				// console.log(elem, attr);
				break;
			}

			demo.setAttribute(attr, value);
		}

		// Convenience functionality for inputs
		for (const input of inputs) {
			input.addEventListener('focus', event => {
				event.target.select();
			});

			input.addEventListener('click', event => {
				event.target.select();
			});

			input.addEventListener('keydown', event => {
				if (event.key === "Enter") {
					event.target.select();
				}
			})
		}
	</script>
</body>
</html>
